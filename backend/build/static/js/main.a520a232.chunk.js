(this.webpackJsonpivwebsocketio=this.webpackJsonpivwebsocketio||[]).push([[0],{111:function(e,t,n){},129:function(e,t,n){},130:function(e,t,n){},132:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),s=n(18),r=n.n(s),o=(n(37),n(20)),i=n(9),l=n(33),m=n(3),u=n(1),j=function(e){return Object(u.jsx)("input",{type:e.type,placeholder:e.placeholder,value:e.value,required:!0,onChange:e.onChange,className:e.className})},d=function(e){return Object(u.jsx)("button",{className:e.className,to:e.to,onClick:e.onClick,value:e.value,children:e.children})},h=(n(72),function(e){var t=Object(m.f)();return e.confirmUsername&&t.push("/".concat(e.roomName)),Object(u.jsxs)("div",{className:"home-container",children:[Object(u.jsx)(j,{type:"text",value:e.username,onChange:e.handleUsernameChange,placeholder:"Name",className:"text-input-field"}),Object(u.jsx)(j,{type:"text",value:e.roomName,onChange:e.handleRoomNameChange,placeholder:"Room",className:"text-input-field"}),Object(u.jsx)(d,{to:"/".concat(e.roomName),className:"enter-room-button",onClick:function(t){t.preventDefault(),e.handleConfirmUsername()},children:"Go"})]})}),b=(n(77),n(28)),f=n.n(b),O=n(65),g=n(64),x=n.n(g),p="http://localhost:3001",v="newChatMessage",N=function(e){var t=e.roomId,n=e.username,a=Object(c.useState)(""),s=Object(i.a)(a,2),r=s[0],l=s[1],m=function(e,t){var n=Object(c.useState)([]),a=Object(i.a)(n,2),s=a[0],r=a[1],l=Object(c.useRef)();return Object(c.useEffect)((function(){return l.current=x()(p,{query:{roomId:e,username:t}}),l.current.on(v,(function(e){var t=Object(o.a)(Object(o.a)({},e),{},{ownedByCurrentUser:e.senderId===l.current.id});r((function(e){return[].concat(Object(O.a)(e),[t])}))})),function(){l.current.disconnect()}}),[e,t]),{messages:s,sendMessage:function(e,t){l.current.emit(v,{username:e,body:t,senderId:l.current.id})}}}(t,n),j=m.messages,h=m.sendMessage;return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("div",{className:"chat-room-container",children:[Object(u.jsxs)("div",{className:"chatroomHeader",children:[Object(u.jsxs)("h1",{className:"room-name",children:["Room: ",t]}),Object(u.jsx)("div",{className:"chatIconDiv1"}),Object(u.jsxs)("div",{className:"chatLogoDiv",children:[Object(u.jsx)("span",{children:Object(u.jsx)(f.a,{style:{fontSize:40}})}),"chatApp"]})]}),Object(u.jsx)("div",{className:"messages-container",children:Object(u.jsx)("ol",{className:"messages-list",children:j.map((function(e,t){return Object(u.jsxs)("li",{className:"message-item ".concat(e.ownedByCurrentUser?"my-message":"received-message"),children:[e.disconnect?Object(u.jsxs)("p",{className:"leave-chatroom",children:[Object(u.jsxs)("strong",{children:[e.disconnect," "]}),"left the chat room"]}):e.connected?Object(u.jsxs)("p",{className:"connect-chatroom",children:[Object(u.jsxs)("strong",{children:[e.connected," "]}),"connected to the chat room"]}):Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("strong",{style:{color:"".concat(e.color)},children:[e.username,":"," "]}),Object(u.jsx)("p",{children:e.body})]}),Object(u.jsx)("p",{className:"time-chatroom",children:e.time})]},t)}))})}),Object(u.jsx)("textarea",{value:r,onChange:function(e){l(e.target.value)},placeholder:"Write message...",className:"new-message-input-field"}),Object(u.jsx)(d,{onClick:function(){h(n,r),l("")},className:"send-message-button",children:"Send"})]})})},C=(n(111),function(e){var t=e.match.params.roomId,n=e.confirmUsername,a=e.handleConfirmUsername,s=e.handleUsernameChange,r=e.username,o=e.handleRoomNameChangeWithLink;return Object(c.useEffect)((function(){o(t)}),[]),Object(u.jsx)(u.Fragment,{children:!1===n?Object(u.jsxs)("div",{className:"chat-lobby-container",children:[Object(u.jsxs)("p",{className:"text-input-field",children:["Please enter your username before entering the room"," ",Object(u.jsx)("strong",{children:t})]}),Object(u.jsx)(j,{value:r,onChange:s,placeholder:"Name",className:"text-input-field",type:"text"}),Object(u.jsx)(d,{className:"enter-room-button",onClick:function(){a()},children:"Enter"})]}):Object(u.jsx)(N,{roomId:t,username:r})})}),y=n(36),U=n.n(y),I={getAll:function(){return U.a.get("".concat(p,"/api/users")).then((function(e){return e.data}))},create:function(e){return U.a.post("".concat(p,"/api/users"),e).then((function(e){return e.data}))}},k=(n(129),function(e){return Object(u.jsx)("div",{className:"backdrop",onClick:e.onConfirm})}),S=function(e){return Object(u.jsxs)("div",{className:"modal",children:[Object(u.jsx)("header",{className:"header",children:Object(u.jsx)("h2",{children:e.title})}),Object(u.jsx)("div",{className:"content",children:Object(u.jsx)("p",{children:e.message})}),Object(u.jsx)("footer",{className:"actions",children:Object(u.jsx)(d,{className:"error-button",onClick:e.onConfirm,children:"Ok"})})]})},w=function(e){return Object(u.jsxs)(a.a.Fragment,{children:[r.a.createPortal(Object(u.jsx)(k,{onConfirm:e.onConfirm}),document.getElementById("error-background-root")),r.a.createPortal(Object(u.jsx)(S,{title:e.title,message:e.message,onConfirm:e.onConfirm}),document.getElementById("error-message-root"))]})},F=(n(130),function(){return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("div",{className:"header",children:[Object(u.jsx)("div",{className:"chatIconDiv",children:Object(u.jsx)(f.a,{style:{fontSize:140}})}),Object(u.jsx)("div",{className:"chatAppDiv",children:"chatApp"})]})})});var R=function(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(!1),r=Object(i.a)(s,2),j=r[0],d=r[1],b=Object(c.useState)(""),f=Object(i.a)(b,2),O=f[0],g=f[1],x=Object(c.useState)(null),p=Object(i.a)(x,2),v=p[0],N=p[1],y=function(e){g(e)},U=function(e){var t=Object(c.useState)([]),n=Object(i.a)(t,2),a=n[0],s=n[1];return Object(c.useEffect)((function(){var e=setTimeout((function(){I.getAll().then((function(e){s(e)})).catch((function(e){console.log("error with get request",e)}))}),500);return function(){clearTimeout(e)}}),[e]),a}(n).map((function(e){return e.username})).find((function(e){return e===n})),k=function(e){a(e.target.value)},S=function(e){if(n.trim().length<1)N({title:"Invalid input",message:"Username must be at least 1 characters long."});else if(U)N({title:"Invalid input",message:"Username '".concat(n,"' is already in use.")});else if(O.trim().length<1)N({title:"Invalid input",message:"Room name must be at least 1 character long"});else{var t={username:n};I.create(t).then((function(e){a(e.person.username),d(!0)})).catch((function(e){console.log("error with get request",e),N({title:"Invalid input",message:"Username '".concat(n,"' is already in use.")}),d(!1)}))}};return Object(u.jsxs)(u.Fragment,{children:[!j&&Object(u.jsx)(F,{}),v&&Object(u.jsx)(w,{title:v.title,message:v.message,onConfirm:function(){N(null)}}),Object(u.jsx)(l.a,{children:Object(u.jsxs)(m.c,{children:[Object(u.jsx)(m.a,{exact:!0,path:"/",children:Object(u.jsx)(h,{username:n,handleUsernameChange:k,confirmUsername:j,setConfirmUsername:d,handleConfirmUsername:S,onlyUniqueUsernames:U,handleRoomNameChange:function(e){g(e.target.value)},roomName:O})}),Object(u.jsx)(m.a,{exact:!0,path:"/:roomId",render:function(e){return Object(u.jsx)(C,Object(o.a)(Object(o.a)({},e),{},{username:n,handleUsernameChange:k,confirmUsername:j,handleConfirmUsername:S,handleRoomNameChangeWithLink:y}))}})]})})]})},E=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,144)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),s(e),r(e)}))};r.a.render(Object(u.jsx)(a.a.StrictMode,{children:Object(u.jsx)(R,{})}),document.getElementById("root")),E()},37:function(e,t,n){},72:function(e,t,n){},77:function(e,t,n){}},[[132,1,2]]]);
//# sourceMappingURL=main.a520a232.chunk.js.map